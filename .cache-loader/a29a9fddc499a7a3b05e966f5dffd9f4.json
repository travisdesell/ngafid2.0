{"remainingRequest":"/ngafid/ngafid2.0/node_modules/babel-loader/lib/index.js??ruleSet[1].rules[0].use[1]!/ngafid/ngafid2.0/src/main/javascript/flights.js","dependencies":[{"path":"/ngafid/ngafid2.0/src/main/javascript/flights.js","mtime":1664810261290},{"path":"/ngafid/ngafid2.0/.babelrc","mtime":1664810261182},{"path":"/ngafid/ngafid2.0/node_modules/cache-loader/dist/cjs.js","mtime":1664910647113},{"path":"/ngafid/ngafid2.0/node_modules/babel-loader/lib/index.js","mtime":1664910647213}],"contextDependencies":[],"result":["function _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nimport 'bootstrap';\nimport React, { Component } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport SignedInNavbar from \"./signed_in_navbar.js\";\nimport { map, styles, layers, Colors, initializeMap } from \"./map.js\";\nimport { Group, Vector as VectorLayer } from 'ol/layer.js';\nimport { Vector as VectorSource } from 'ol/source.js';\nimport { Circle, Fill, Icon, Stroke, Style } from 'ol/style.js';\nimport { errorModal } from \"./error_modal.js\";\nimport { confirmModal } from \"./confirm_modal.js\";\nimport { Filter } from './filter.js';\nimport { Paginator } from './paginator_component.js';\nimport { FlightsCard } from './flights_card_component.js';\nimport Plotly from 'plotly.js';\nimport { timeZones } from \"./time_zones.js\";\n\nfunction invalidString(str) {\n  return str == null || str.length < 0 || /^\\s*$/.test(str);\n}\n/*\nvar airframes = [ \"PA-28-181\", \"Cessna 172S\", \"PA-44-180\", \"Cirrus SR20\"  ];\nvar tailNumbers = [ \"N765ND\", \"N744ND\", \"N771ND\", \"N731ND\", \"N714ND\", \"N766ND\", \"N743ND\" , \"N728ND\" , \"N768ND\" , \"N713ND\" , \"N732ND\", \"N718ND\" , \"N739ND\" ];\nvar doubleTimeSeriesNames = [ \"E1 CHT1\", \"E1 CHT2\", \"E1 CHT3\" ];\nvar visitedAirports = [ \"GFK\", \"FAR\", \"ALB\", \"ROC\" ];\n*/\n// var tagNames = [\"Tag A\", \"Tag B\"];\n\n\nvar rules = [{\n  name: \"Airframe\",\n  conditions: [{\n    type: \"select\",\n    name: \"condition\",\n    options: [\"is\", \"is not\"]\n  }, {\n    type: \"select\",\n    name: \"airframes\",\n    options: airframes\n  }]\n}, {\n  name: \"Tail Number\",\n  conditions: [{\n    type: \"select\",\n    name: \"condition\",\n    options: [\"is\", \"is not\"]\n  }, {\n    type: \"select\",\n    name: \"tail numbers\",\n    options: tailNumbers\n  }]\n}, {\n  name: \"System ID\",\n  conditions: [{\n    type: \"select\",\n    name: \"condition\",\n    options: [\"is\", \"is not\"]\n  }, {\n    type: \"select\",\n    name: \"system id\",\n    options: systemIds\n  }]\n}, {\n  name: \"Duration\",\n  conditions: [{\n    type: \"select\",\n    name: \"condition\",\n    options: [\"<=\", \"<\", \"=\", \">\", \">=\"]\n  }, {\n    type: \"number\",\n    name: \"hours\"\n  }, {\n    type: \"number\",\n    name: \"minutes\"\n  }, {\n    type: \"number\",\n    name: \"seconds\"\n  }]\n}, {\n  name: \"Start Date and Time\",\n  conditions: [{\n    type: \"select\",\n    name: \"condition\",\n    options: [\"<=\", \"<\", \"=\", \">\", \">=\"]\n  }, {\n    type: \"datetime-local\",\n    name: \"date and time\"\n  }, {\n    type: \"select\",\n    name: \"timezone\",\n    options: timeZones\n  }]\n}, {\n  name: \"End Date and Time\",\n  conditions: [{\n    type: \"select\",\n    name: \"condition\",\n    options: [\"<=\", \"<\", \"=\", \">\", \">=\"]\n  }, {\n    type: \"datetime-local\",\n    name: \"date and time\"\n  }, {\n    type: \"select\",\n    name: \"timezone\",\n    options: timeZones\n  }]\n}, {\n  name: \"Start Date\",\n  conditions: [{\n    type: \"select\",\n    name: \"condition\",\n    options: [\"<=\", \"<\", \"=\", \">\", \">=\"]\n  }, {\n    type: \"date\",\n    name: \"date\"\n  }]\n}, {\n  name: \"End Date\",\n  conditions: [{\n    type: \"select\",\n    name: \"condition\",\n    options: [\"<=\", \"<\", \"=\", \">\", \">=\"]\n  }, {\n    type: \"date\",\n    name: \"date\"\n  }]\n}, {\n  name: \"Start Time\",\n  conditions: [{\n    type: \"select\",\n    name: \"condition\",\n    options: [\"<=\", \"<\", \"=\", \">\", \">=\"]\n  }, {\n    type: \"time\",\n    name: \"time\"\n  }, {\n    type: \"select\",\n    name: \"timezone\",\n    options: timeZones\n  }]\n}, {\n  name: \"End Time\",\n  conditions: [{\n    type: \"select\",\n    name: \"condition\",\n    options: [\"<=\", \"<\", \"=\", \">\", \">=\"]\n  }, {\n    type: \"time\",\n    name: \"time\"\n  }, {\n    type: \"select\",\n    name: \"timezone\",\n    options: timeZones\n  }]\n}, {\n  name: \"Parameter\",\n  conditions: [{\n    type: \"select\",\n    name: \"statistic\",\n    options: [\"min\", \"avg\", \"max\"]\n  }, {\n    type: \"select\",\n    name: \"doubleSeries\",\n    options: doubleTimeSeriesNames\n  }, {\n    type: \"select\",\n    name: \"condition\",\n    options: [\"<=\", \"<\", \"=\", \">\", \">=\"]\n  }, {\n    type: \"number\",\n    name: \"number\"\n  }]\n}, {\n  name: \"Airport\",\n  conditions: [{\n    type: \"select\",\n    name: \"airports\",\n    options: visitedAirports\n  }, {\n    type: \"select\",\n    name: \"condition\",\n    options: [\"visited\", \"not visited\"]\n  }]\n}, {\n  name: \"Runway\",\n  conditions: [{\n    type: \"select\",\n    name: \"runways\",\n    options: visitedRunways\n  }, {\n    type: \"select\",\n    name: \"condition\",\n    options: [\"visited\", \"not visited\"]\n  }]\n}, {\n  name: \"Event Count\",\n  conditions: [{\n    type: \"select\",\n    name: \"eventNames\",\n    options: eventNames\n  }, {\n    type: \"select\",\n    name: \"condition\",\n    options: [\"<=\", \"<\", \"=\", \">\", \">=\"]\n  }, {\n    type: \"number\",\n    name: \"number\"\n  }]\n}, {\n  name: \"Event Severity\",\n  conditions: [{\n    type: \"select\",\n    name: \"eventNames\",\n    options: eventNames\n  }, {\n    type: \"select\",\n    name: \"condition\",\n    options: [\"<=\", \"<\", \"=\", \">\", \">=\"]\n  }, {\n    type: \"number\",\n    name: \"number\"\n  }]\n}, {\n  name: \"Event Duration\",\n  conditions: [{\n    type: \"select\",\n    name: \"eventNames\",\n    options: eventNames\n  }, {\n    type: \"select\",\n    name: \"condition\",\n    options: [\"<=\", \"<\", \"=\", \">\", \">=\"]\n  }, {\n    type: \"number\",\n    name: \"number\"\n  }]\n}, {\n  name: \"Tag\",\n  conditions: [{\n    type: \"select\",\n    name: \"flight_tags\",\n    options: tagNames\n  }, {\n    type: \"select\",\n    name: \"condition\",\n    options: [\"Is Associated\", \"Is Not Associated\"]\n  }]\n}];\nvar sortableColumns = new Map();\nsortableColumns.set(\"Flight Number\", \"id\");\nsortableColumns.set(\"Flight Length (Number of Valid Data Points)\", \"number_rows\");\nsortableColumns.set(\"Start Date and Time\", \"start_time\");\nsortableColumns.set(\"End Date and Time\", \"end_time\");\nsortableColumns.set(\"Number of Airports Visited\", \"airports_visited\");\nsortableColumns.set(\"Number of Tags Associated\", \"flight_tags\");\nsortableColumns.set(\"Total Event Count\", \"events\");\nsortableColumns.set(\"System ID\", \"system_id\");\nsortableColumns.set(\"Tail Number\", \"tail_number\");\nsortableColumns.set(\"Airframe\", \"airframe_id\");\nsortableColumns.set(\"Number of Takeoffs/Landings\", \"itinerary\");\n\nvar FlightsPage = /*#__PURE__*/function (_React$Component) {\n  _inherits(FlightsPage, _React$Component);\n\n  var _super = _createSuper(FlightsPage);\n\n  function FlightsPage(props) {\n    var _this;\n\n    _classCallCheck(this, FlightsPage);\n\n    _this = _super.call(this, props);\n    _this.state = {\n      filterVisible: true,\n      filterSelected: true,\n      plotVisible: false,\n      plotSelected: false,\n      mapVisible: false,\n      mapSelected: false,\n      mapStyle: \"Road\",\n      flightsRef: /*#__PURE__*/React.createRef(),\n      layers: [],\n      flights: undefined,\n      //start out with no specified flights\n      sortColumn: \"Start Date and Time\",\n      //need to define a default here, flt# will alias to primary key server side\n      sortingOrder: \"Descending\",\n      //need to define a default here, descending is default\n      storedFilters: _this.getStoredFilters(),\n      filters: {\n        type: \"GROUP\",\n        condition: \"AND\",\n        filters: []\n      },\n      //needed for paginator\n      currentPage: 0,\n      numberPages: 1,\n      pageSize: 10\n    };\n    _this.navRef = /*#__PURE__*/React.createRef();\n    return _this;\n  }\n\n  _createClass(FlightsPage, [{\n    key: \"mapSelectChanged\",\n    value: function mapSelectChanged(style) {\n      for (var i = 0, ii = layers.length; i < ii; ++i) {\n        console.log(\"setting layer \" + i + \" to:\" + (styles[i] === style));\n        layers[i].setVisible(styles[i] === style);\n      }\n\n      console.log(\"map style changed to: '\" + style + \"'!\");\n      this.setState({\n        mapStyle: style\n      });\n    }\n  }, {\n    key: \"mapLayerChanged\",\n    value: function mapLayerChanged(style) {\n      console.log(\"changing path to: \" + style);\n      console.log(this.state.selectableLayers);\n\n      for (var i = 0; i < this.state.selectableLayers.length; i++) {\n        var layer = this.state.selectableLayers[i];\n        var name = layer.values_.name;\n\n        if (name == style) {\n          layer.setVisible(true);\n          console.log(\"setting layer \" + name + \" to visible\");\n        } else {\n          layer.setVisible(false);\n          console.log(\"setting layer \" + name + \" to not visible\");\n        }\n      }\n\n      console.log(\"map layer changed to: '\" + style + \"'!\");\n      this.setMapStyle(style);\n    }\n  }, {\n    key: \"setMapStyle\",\n    value: function setMapStyle(style) {\n      this.setState({\n        mapStyle: style\n      });\n    }\n  }, {\n    key: \"setSortingColumn\",\n    value: function setSortingColumn(column) {\n      console.log(\"sorting by: \" + column);\n      this.state.sortColumn = column;\n      this.setState(this.state);\n      this.submitFilter(true);\n    }\n  }, {\n    key: \"getSortingColumn\",\n    value: function getSortingColumn() {\n      return this.state.sortColumn;\n    }\n  }, {\n    key: \"setSortingOrder\",\n    value: function setSortingOrder(order) {\n      if (order != this.state.sortingOrder) {\n        console.log(\"sorting in \" + order + \" order\");\n        this.state.sortingOrder = order;\n        this.setState(this.state);\n        this.submitFilter(true);\n      }\n    }\n  }, {\n    key: \"getSortingOrder\",\n    value: function getSortingOrder() {\n      return this.state.sortingOrder;\n    }\n  }, {\n    key: \"showMap\",\n    value: function showMap() {\n      if (this.state.mapVisible) return;\n\n      if (!$(\"#map-toggle-button\").hasClass(\"active\")) {\n        $(\"#map-toggle-button\").addClass(\"active\");\n        $(\"#map-toggle-button\").attr(\"aria-pressed\", true);\n      }\n\n      this.state.mapVisible = true;\n      this.setState(this.state);\n      $(\"#plot-map-div\").css(\"height\", \"50%\");\n      $(\"#map\").show();\n\n      if (this.state.plotVisible) {\n        $(\"#map\").css(\"width\", \"50%\");\n        map.updateSize();\n        $(\"#plot\").css(\"width\", \"50%\");\n        Plotly.Plots.resize(\"plot\");\n      } else {\n        $(\"#map\").css(\"width\", \"100%\");\n        map.updateSize();\n      }\n    }\n  }, {\n    key: \"hideMap\",\n    value: function hideMap() {\n      if (!this.state.mapVisible) return;\n\n      if ($(\"#map-toggle-button\").hasClass(\"active\")) {\n        $(\"#map-toggle-button\").removeClass(\"active\");\n        $(\"#map-toggle-button\").attr(\"aria-pressed\", false);\n      }\n\n      this.state.mapVisible = false;\n      this.setState(this.state);\n      $(\"#map\").hide();\n\n      if (this.state.plotVisible) {\n        $(\"#plot\").css(\"width\", \"100%\");\n        var update = {\n          width: \"100%\"\n        };\n        Plotly.Plots.resize(\"plot\");\n      } else {\n        $(\"#plot-map-div\").css(\"height\", \"0%\");\n      }\n    }\n  }, {\n    key: \"toggleMap\",\n    value: function toggleMap() {\n      if (this.state.mapVisible) {\n        this.hideMap();\n      } else {\n        this.showMap();\n      }\n    }\n  }, {\n    key: \"showPlot\",\n    value: function showPlot() {\n      if (this.state.plotVisible) return;\n\n      if (!$(\"#plot-toggle-button\").hasClass(\"active\")) {\n        $(\"#plot-toggle-button\").addClass(\"active\");\n        $(\"#plot-toggle-button\").attr(\"aria-pressed\", true);\n      }\n\n      this.state.plotVisible = true;\n      this.setState(this.state);\n      $(\"#plot\").show();\n      $(\"#plot-map-div\").css(\"height\", \"50%\");\n\n      if (this.state.mapVisible) {\n        $(\"#map\").css(\"width\", \"50%\");\n        map.updateSize();\n        $(\"#plot\").css(\"width\", \"50%\");\n        Plotly.Plots.resize(\"plot\");\n      } else {\n        $(\"#plot\").css(\"width\", \"100%\");\n        Plotly.Plots.resize(\"plot\");\n      }\n    }\n  }, {\n    key: \"hidePlot\",\n    value: function hidePlot() {\n      if (!this.state.plotVisible) return;\n\n      if ($(\"#plot-toggle-button\").hasClass(\"active\")) {\n        $(\"#plot-toggle-button\").removeClass(\"active\");\n        $(\"#plot-toggle-button\").attr(\"aria-pressed\", false);\n      }\n\n      this.state.plotVisible = false;\n      this.setState(this.state);\n      $(\"#plot\").hide();\n\n      if (this.state.mapVisible) {\n        $(\"#map\").css(\"width\", \"100%\");\n        map.updateSize();\n      } else {\n        $(\"#plot-map-div\").css(\"height\", \"0%\");\n      }\n    }\n  }, {\n    key: \"togglePlot\",\n    value: function togglePlot() {\n      if (this.state.plotVisible) {\n        this.hidePlot();\n      } else {\n        this.showPlot();\n      }\n    }\n  }, {\n    key: \"toggleFilter\",\n    value: function toggleFilter() {\n      console.log(\"toggling filterVisible to: \" + !this.state.filterVisible);\n      this.setState({\n        filterVisible: !this.state.filterVisible\n      });\n    }\n  }, {\n    key: \"setFilter\",\n    value: function setFilter(filter) {\n      this.setState({\n        filters: filter\n      });\n    }\n  }, {\n    key: \"getStoredFilters\",\n    value: function getStoredFilters() {\n      var storedFilters = [];\n      $.ajax({\n        type: 'GET',\n        url: '/protected/stored_filters',\n        dataType: 'json',\n        success: function success(response) {\n          console.log(\"received filters response: \");\n          console.log(response);\n          storedFilters = response;\n        },\n        error: function error(jqXHR, textStatus, errorThrown) {},\n        async: false\n      });\n      return storedFilters;\n    }\n  }, {\n    key: \"submitFilter\",\n    value: function submitFilter() {\n      var resetCurrentPage = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      console.log(\"submitting filter! currentPage: \" + this.state.currentPage + \", pageSize: \" + this.state.pageSize + \" sortByColumn: \" + this.state.sortColumn);\n      console.log(\"Submitting filters:\");\n      console.log(this.state.filters);\n      $(\"#loading\").show(); //reset the current page to 0 if the page size or filter\n      //have changed\n\n      var currentPage = this.state.currentPage;\n\n      if (resetCurrentPage === true) {\n        currentPage = 0;\n      }\n\n      var submissionData = {\n        filterQuery: JSON.stringify(this.state.filters),\n        currentPage: currentPage,\n        pageSize: this.state.pageSize,\n        sortingColumn: sortableColumns.get(this.state.sortColumn),\n        sortingOrder: this.state.sortingOrder\n      };\n      console.log(submissionData);\n      var flightsPage = this;\n      $.ajax({\n        type: 'POST',\n        url: '/protected/get_flights',\n        data: submissionData,\n        dataType: 'json',\n        timeout: 0,\n        //set timeout to be unlimited for slow queries\n        success: function success(response) {\n          console.log(response);\n          $(\"#loading\").hide();\n\n          if (response.errorTitle) {\n            console.log(\"displaying error modal!\");\n            errorModal.show(response.errorTitle, response.errorMessage);\n            return false;\n          }\n\n          console.log(\"got response: \" + response + \" \" + response.size); //get page data\n\n          if (response == \"NO_RESULTS\") {\n            errorModal.show(\"No flights found with the given parameters!\", \"Please try a different query.\");\n          } else {\n            flightsPage.setState({\n              flights: response.flights,\n              currentPage: currentPage,\n              numberPages: response.numberPages\n            });\n          }\n        },\n        error: function error(jqXHR, textStatus, errorThrown) {\n          errorModal.show(\"Error Loading Flights\", errorThrown);\n        },\n        async: true\n      });\n    }\n  }, {\n    key: \"setAvailableLayers\",\n    value: function setAvailableLayers(plotLayers) {\n      console.log(\"changing selectable layers on navbar\");\n      console.log(plotLayers);\n      this.setState({\n        selectableLayers: plotLayers\n      });\n    } //Tag Methods:\n    //\n\n  }, {\n    key: \"addTag\",\n    value: function addTag(flightId, name, description, color) {\n      if (invalidString(name) || invalidString(description)) {\n        errorModal.show(\"Error creating tag!\", \"Please ensure the name and description fields are correctly filled out!\");\n        return;\n      }\n\n      var submissionData = {\n        name: name,\n        description: description,\n        color: color,\n        id: flightId\n      };\n      console.log(\"Creating a new tag for flight # \" + this.state.flightId);\n      var thisFlight = this;\n      $.ajax({\n        type: 'POST',\n        url: '/protected/create_tag',\n        data: submissionData,\n        dataType: 'json',\n        success: function success(response) {\n          console.log(\"received response: \");\n          console.log(response);\n\n          if (response != \"ALREADY_EXISTS\") {\n            for (var i = 0; i < thisFlight.state.flights.length; i++) {\n              var flight = thisFlight.state.flights[i];\n\n              if (flight.id == flightId) {\n                if (flight.tags != null && flight.tags.length > 0) {\n                  flight.tags.push(response);\n                } else {\n                  flight.tags = [response];\n                }\n              }\n            }\n\n            thisFlight.setState(thisFlight.state);\n          } else {\n            errorModal.show(\"Error creating tag\", \"A tag with that name already exists! Use the dropdown menu to associate it with this flight or give this tag another name\");\n          }\n        },\n        error: function error(jqXHR, textStatus, errorThrown) {},\n        async: true\n      });\n    }\n    /**\n     * Calls the server using ajax-json to notify it of the new tag change\n     */\n\n  }, {\n    key: \"editTag\",\n    value: function editTag(newTag, currentTag) {\n      console.log(\"submitting edit for tag: \" + currentTag.hashId);\n      console.log(\"current tag\");\n      console.log(currentTag);\n      console.log(\"new tag\");\n      console.log(newTag);\n      var submissionData = {\n        tag_id: currentTag.hashId,\n        name: newTag.name,\n        description: newTag.description,\n        color: newTag.color\n      };\n      var thisFlight = this;\n      $.ajax({\n        type: 'POST',\n        url: '/protected/edit_tag',\n        data: submissionData,\n        dataType: 'json',\n        success: function success(response) {\n          console.log(\"received response: \");\n          console.log(response);\n\n          if (response != \"NOCHANGE\") {\n            console.log(\"tag was edited!\");\n\n            for (var i = 0; i < thisFlight.state.flights.length; i++) {\n              var flight = thisFlight.state.flights[i];\n              console.log(flight);\n              console.log(currentTag);\n\n              if (flight.tags != null && flight.tags.length > 0) {\n                var tags = flight.tags;\n\n                for (var j = 0; j < tags.length; j++) {\n                  var _tag = tags[j];\n\n                  if (_tag.hashId == currentTag.hashId) {\n                    tags[j] = response;\n                  }\n                }\n              }\n            }\n\n            thisFlight.setState(thisFlight.state);\n          } else {\n            thisFlight.showNoEditError();\n          }\n\n          thisFlight.setState(thisFlight.state);\n        },\n        error: function error(jqXHR, textStatus, errorThrown) {},\n        async: true\n      });\n    }\n  }, {\n    key: \"getUnassociatedTags\",\n    value: function getUnassociatedTags(flightId) {\n      console.log(\"getting unassociated tags!\");\n      var tags = [];\n      var submissionData = {\n        id: flightId\n      };\n      $.ajax({\n        type: 'POST',\n        url: '/protected/get_unassociated_tags',\n        data: submissionData,\n        dataType: 'json',\n        success: function success(response) {\n          console.log(\"received response: \");\n          console.log(response);\n          tags = response;\n        },\n        error: function error(jqXHR, textStatus, errorThrown) {},\n        async: false\n      });\n      return tags;\n    }\n    /**\n     * Handles when the user presses the delete button, and prompts them with @module confirmModal\n     */\n\n  }, {\n    key: \"deleteTag\",\n    value: function deleteTag(flightId, tagId) {\n      var _this2 = this;\n\n      console.log(tag);\n\n      if (tagId != null) {\n        console.log(\"delete tag invoked!\");\n        confirmModal.show(\"Confirm Delete Tag: '\" + tag.name + \"'\", \"Are you sure you wish to delete this tag?\\n\\nThis operation will remove it from this flight as well as all other flights that this tag is associated with. This operation cannot be undone!\", function () {\n          _this2.removeTag(flightId, tagId, true);\n        });\n      } else {\n        errorModal.show(\"Please select a tag to delete first!\", \"You did not select a tag to delete\");\n      }\n    }\n    /**\n     * removes a tag from a flight, either permanent or just from one flight\n     * @param id the tagid of the tag being removed\n     * @param tag is the tag being removed\n     * @param isPermanent a bool representing whether or not the removal is permanent\n     */\n\n  }, {\n    key: \"removeTag\",\n    value: function removeTag(flightId, tagId, isPermanent) {\n      console.log(\"un-associating tag #\" + tagId + \" with flight #\" + flightId);\n\n      if (tagId == null || tagId == -1) {\n        errorModal.show(\"Please select a flight to remove first!\", \"Cannot remove any flights!\");\n        return;\n      }\n\n      var submissionData = {\n        flight_id: flightId,\n        tag_id: tagId,\n        permanent: isPermanent,\n        all: tagId == -2\n      };\n      var thisFlight = this;\n      console.log(\"calling deletion ajax\");\n      $.ajax({\n        type: 'POST',\n        url: '/protected/remove_tag',\n        data: submissionData,\n        dataType: 'json',\n        success: function success(response) {\n          console.log(\"received response: \");\n          console.log(response);\n\n          if (isPermanent) {\n            console.log(\"permanent deletion of tag with id: \" + tagId);\n\n            for (var i = 0; i < thisFlight.state.flights.length; i++) {\n              var flight = thisFlight.state.flights[i];\n              console.log(flight);\n\n              if (flight.tags != null) {\n                var tags = flight.tags;\n\n                for (var j = 0; j < tags.length; j++) {\n                  var _tag2 = tags[j];\n\n                  if (tagId == response.tagId) {\n                    tags.splice(j, 1);\n                  }\n                }\n              }\n            }\n          } else if (response.allTagsCleared) {\n            for (var i = 0; i < thisFlight.state.flights.length; i++) {\n              var _flight = thisFlight.state.flights[i];\n\n              if (_flight.id == flightId) {\n                _flight.tags = [];\n              }\n            }\n          } else {\n            for (var i = 0; i < thisFlight.state.flights.length; i++) {\n              var _flight2 = thisFlight.state.flights[i];\n              var _tags = _flight2.tags;\n\n              if (_flight2.id == flightId) {\n                var _tags2 = _flight2.tags;\n\n                _tags2.splice(_tags2.indexOf(tag), 1);\n              }\n            }\n          }\n\n          thisFlight.setState(thisFlight.state);\n        },\n        error: function error(jqXHR, textStatus, errorThrown) {},\n        async: false\n      });\n    }\n    /**\n     * Associates a tag with this flight\n     * @param id the tag id to associate\n     */\n\n  }, {\n    key: \"associateTag\",\n    value: function associateTag(tagId, flightId) {\n      console.log(\"associating tag #\" + tagId + \" with flight #\" + flightId);\n      var submissionData = {\n        id: flightId,\n        tag_id: tagId\n      };\n      var thisFlight = this;\n      $.ajax({\n        type: 'POST',\n        url: '/protected/associate_tag',\n        data: submissionData,\n        dataType: 'json',\n        success: function success(response) {\n          console.log(\"received response: \");\n          console.log(response);\n\n          for (var i = 0; i < thisFlight.state.flights.length; i++) {\n            var flight = thisFlight.state.flights[i];\n\n            if (flight.id == flightId) {\n              if (flight.tags != null && flight.tags.length > 0) {\n                flight.tags.push(response);\n              } else {\n                flight.tags = [response];\n              }\n            }\n          }\n\n          thisFlight.setState(thisFlight.state);\n        },\n        error: function error(jqXHR, textStatus, errorThrown) {},\n        async: true\n      });\n    }\n    /**\n     * Handles when the user presses the clear all tags button, and prompts them with @module confirmModal\n     */\n\n  }, {\n    key: \"clearTags\",\n    value: function clearTags(flightId) {\n      var _this3 = this;\n\n      confirmModal.show(\"Confirm action\", \"Are you sure you would like to remove all the tags from flight #\" + flightId + \"?\", function () {\n        _this3.removeTag(flightId, -2, false);\n      });\n    }\n    /**\n     * Handles clearing all selected flights for multiple flight replays\n     */\n\n  }, {\n    key: \"clearCesiumFlights\",\n    value: function clearCesiumFlights() {\n      cesiumFlightsSelected.forEach(function (removedFlight) {\n        console.log(\"Removed \" + removedFlight);\n        var toggleButton = document.getElementById(\"cesiumToggled\" + removedFlight);\n        toggleButton.click();\n      });\n\n      if (cesiumFlightsSelected.length > 0) {\n        this.clearCesiumFlights();\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      var style = null;\n\n      if (this.state.mapVisible || this.state.plotVisible) {\n        console.log(\"rendering half\");\n        style = {\n          overflow: \"scroll\",\n          height: \"calc(50%)\"\n        };\n      } else {\n        style = {\n          overflow: \"scroll\",\n          height: \"calc(100%)\"\n        };\n      }\n\n      style.padding = \"5\";\n      var sortableColumnsHumanReadable = Array.from(sortableColumns.keys());\n      return /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(SignedInNavbar, {\n        activePage: \"flights\",\n        selectableLayers: this.state.selectableLayers,\n        filterVisible: true,\n        plotVisible: this.state.plotVisible,\n        mapVisible: this.state.mapVisible,\n        filterSelected: this.state.filterSelected,\n        plotSelected: this.state.plotSelected,\n        mapSelected: this.state.mapSelected,\n        mapStyle: this.state.mapStyle,\n        togglePlot: function togglePlot() {\n          return _this4.togglePlot();\n        },\n        toggleFilter: function toggleFilter() {\n          return _this4.toggleFilter();\n        },\n        toggleMap: function toggleMap() {\n          return _this4.toggleMap();\n        },\n        mapSelectChanged: function mapSelectChanged(style) {\n          return _this4.mapSelectChanged(style);\n        },\n        mapLayerChanged: function mapLayerChanged(style) {\n          return _this4.mapLayerChanged(style);\n        },\n        waitingUserCount: waitingUserCount,\n        fleetManager: fleetManager,\n        ref: this.navRef,\n        unconfirmedTailsCount: unconfirmedTailsCount,\n        modifyTailsAccess: modifyTailsAccess\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        id: \"plot-map-div\",\n        className: \"row m-0\",\n        style: {\n          width: \"100%\",\n          height: \"0%\"\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        id: \"map\",\n        className: \"map\",\n        style: {\n          width: \"50%\",\n          display: \"none\"\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        id: \"plot\",\n        style: {\n          width: \"50%\",\n          display: \"none\"\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        style: style\n      }, /*#__PURE__*/React.createElement(Filter, {\n        filterVisible: this.state.filterVisible,\n        submitButtonName: \"Apply Filter\",\n        submitFilter: function submitFilter(resetCurrentPage) {\n          _this4.submitFilter(resetCurrentPage);\n        },\n        rules: rules,\n        filters: this.state.filters,\n        getFilter: function getFilter() {\n          return _this4.state.filters;\n        },\n        setFilter: function setFilter(filter) {\n          return _this4.setFilter(filter);\n        },\n        setCurrentSortingColumn: function setCurrentSortingColumn(sortColumn) {\n          return _this4.setCurrentSortingColumn(sortColumn);\n        },\n        getCurrentSortingColumn: function getCurrentSortingColumn() {\n          return _this4.getCurrentSortingColumn();\n        }\n      }), /*#__PURE__*/React.createElement(Paginator, {\n        submitFilter: function submitFilter(resetCurrentPage) {\n          _this4.submitFilter(resetCurrentPage);\n        },\n        items: this.state.flights,\n        itemName: \"flights\",\n        currentPage: this.state.currentPage,\n        numberPages: this.state.numberPages,\n        pageSize: this.state.pageSize,\n        rules: sortableColumns,\n        setClearButton: function setClearButton() {\n          return _this4.clearCesiumFlights();\n        },\n        setSortingColumn: function setSortingColumn(sortColumn) {\n          return _this4.setSortingColumn(sortColumn);\n        },\n        getSortingColumn: function getSortingColumn() {\n          return _this4.getSortingColumn();\n        },\n        setSortingOrder: function setSortingOrder(order) {\n          return _this4.setSortingOrder(order);\n        },\n        getSortingOrder: function getSortingOrder() {\n          return _this4.getSortingOrder();\n        },\n        sortOptions: sortableColumnsHumanReadable,\n        updateCurrentPage: function updateCurrentPage(currentPage) {\n          _this4.state.currentPage = currentPage;\n        },\n        updateItemsPerPage: function updateItemsPerPage(pageSize) {\n          _this4.state.pageSize = pageSize;\n        },\n        location: \"Top\"\n      }), /*#__PURE__*/React.createElement(FlightsCard, {\n        parent: this,\n        layers: this.state.layers,\n        flights: this.state.flights,\n        navBar: this.navRef,\n        ref: function ref(elem) {\n          return _this4.flightsRef = elem;\n        },\n        showMap: function showMap() {\n          _this4.showMap();\n        },\n        showPlot: function showPlot() {\n          _this4.showPlot();\n        },\n        setAvailableLayers: function setAvailableLayers(plotLayers) {\n          _this4.setAvailableLayers(plotLayers);\n        },\n        setFlights: function setFlights(flights) {\n          _this4.setState({\n            flights: flights\n          });\n        },\n        updateNumberPages: function updateNumberPages(numberPages) {\n          _this4.setState({\n            numberPages: numberPages\n          });\n        },\n        addTag: function addTag(flightId, name, description, color) {\n          return _this4.addTag(flightId, name, description, color);\n        },\n        removeTag: function removeTag(flightId, tagId, perm) {\n          return _this4.removeTag(flightId, tagId, perm);\n        },\n        deleteTag: function deleteTag(flightId, tagId) {\n          return _this4.deleteTag(flightId, tagId);\n        },\n        getUnassociatedTags: function getUnassociatedTags(flightId) {\n          return _this4.getUnassociatedTags(flightId);\n        },\n        associateTag: function associateTag(tagId, flightId) {\n          return _this4.associateTag(tagId, flightId);\n        },\n        clearTags: function clearTags(flightId) {\n          return _this4.clearTags(flightId);\n        },\n        editTag: function editTag(currentTag, newTag) {\n          return _this4.editTag(currentTag, newTag);\n        }\n      }), /*#__PURE__*/React.createElement(Paginator, {\n        submitFilter: function submitFilter(resetCurrentPage) {\n          _this4.submitFilter(resetCurrentPage);\n        },\n        items: this.state.flights,\n        itemName: \"flights\",\n        rules: sortableColumns,\n        currentPage: this.state.currentPage,\n        numberPages: this.state.numberPages,\n        pageSize: this.state.pageSize,\n        setSortingColumn: function setSortingColumn(sortColumn) {\n          return _this4.setSortingColumn(sortColumn);\n        },\n        getSortingColumn: function getSortingColumn() {\n          return _this4.getSortingColumn();\n        },\n        setSortingOrder: function setSortingOrder(order) {\n          return _this4.setSortingOrder(order);\n        },\n        getSortingOrder: function getSortingOrder() {\n          return _this4.getSortingOrder();\n        },\n        sortOptions: sortableColumnsHumanReadable,\n        updateCurrentPage: function updateCurrentPage(currentPage) {\n          _this4.state.currentPage = currentPage;\n        },\n        updateItemsPerPage: function updateItemsPerPage(pageSize) {\n          _this4.state.pageSize = pageSize;\n        },\n        location: \"Bottom\"\n      })));\n    }\n  }]);\n\n  return FlightsPage;\n}(React.Component);\n\nglobal.plotlyLayout = {\n  shapes: []\n};\nvar flightsPage = ReactDOM.render( /*#__PURE__*/React.createElement(FlightsPage, null), document.querySelector('#flights-page'));\nconsole.log(\"rendered flightsCard!\"); //need to wait for the page to load before initializing maps\n//TODO: this is the same as in flights.js, put it in a single spot\n\n$(document).ready(function () {\n  Plotly.newPlot('plot', [], global.plotlyLayout);\n  initializeMap();\n  var myPlot = document.getElementById(\"plot\");\n  console.log(\"myPlot:\");\n  console.log(myPlot);\n  myPlot.on('plotly_hover', function (data) {\n    var xaxis = data.points[0].xaxis,\n        yaxis = data.points[0].yaxis;\n    /*\n        var infotext = data.points.map(function(d) {\n            return ('width: '+xaxis.l2p(d.x)+', height: '+yaxis.l2p(d.y));\n        });\n        */\n    //console.log(\"in hover!\");\n    //console.log(data);\n\n    var x = data.points[0].x; //console.log(\"x: \" + x);\n\n    map.getLayers().forEach(function (layer) {\n      if (layer instanceof VectorLayer) {\n        if ('flightState' in layer) {\n          //console.log(\"VECTOR layer:\");\n          var hiddenStyle = new Style({\n            stroke: new Stroke({\n              color: layer.flightState.state.color,\n              width: 1.5\n            }),\n            image: new Circle({\n              radius: 5,\n              stroke: new Stroke({\n                color: [0, 0, 0, 0],\n                width: 2\n              })\n            })\n          });\n          var visibleStyle = new Style({\n            stroke: new Stroke({\n              color: layer.flightState.state.color,\n              width: 1.5\n            }),\n            image: new Circle({\n              radius: 5,\n              stroke: new Stroke({\n                color: layer.flightState.state.color,\n                width: 2\n              })\n            })\n          });\n\n          if (layer.getVisible()) {\n            if (x < layer.flightState.state.points.length) {\n              console.log(\"need to draw point at: \" + layer.flightState.state.points[x]);\n              layer.flightState.state.trackingPoint.setStyle(visibleStyle);\n              layer.flightState.state.trackingPoint.getGeometry().setCoordinates(layer.flightState.state.points[x]);\n            } else {\n              console.log(\"not drawing point x: \" + x + \" >= points.length: \" + layer.flightState.state.points.length);\n              layer.flightState.state.trackingPoint.setStyle(hiddenStyle);\n            }\n          }\n        }\n      }\n    });\n  });\n});",{"version":3,"names":["React","Component","ReactDOM","SignedInNavbar","map","styles","layers","Colors","initializeMap","Group","Vector","VectorLayer","VectorSource","Circle","Fill","Icon","Stroke","Style","errorModal","confirmModal","Filter","Paginator","FlightsCard","Plotly","timeZones","invalidString","str","length","test","rules","name","conditions","type","options","airframes","tailNumbers","systemIds","doubleTimeSeriesNames","visitedAirports","visitedRunways","eventNames","tagNames","sortableColumns","Map","set","FlightsPage","props","state","filterVisible","filterSelected","plotVisible","plotSelected","mapVisible","mapSelected","mapStyle","flightsRef","createRef","flights","undefined","sortColumn","sortingOrder","storedFilters","getStoredFilters","filters","condition","currentPage","numberPages","pageSize","navRef","style","i","ii","console","log","setVisible","setState","selectableLayers","layer","values_","setMapStyle","column","submitFilter","order","$","hasClass","addClass","attr","css","show","updateSize","Plots","resize","removeClass","hide","update","width","hideMap","showMap","hidePlot","showPlot","filter","ajax","url","dataType","success","response","error","jqXHR","textStatus","errorThrown","async","resetCurrentPage","submissionData","filterQuery","JSON","stringify","sortingColumn","get","flightsPage","data","timeout","errorTitle","errorMessage","size","plotLayers","flightId","description","color","id","thisFlight","flight","tags","push","newTag","currentTag","hashId","tag_id","j","tag","showNoEditError","tagId","removeTag","isPermanent","flight_id","permanent","all","splice","allTagsCleared","indexOf","cesiumFlightsSelected","forEach","removedFlight","toggleButton","document","getElementById","click","clearCesiumFlights","overflow","height","padding","sortableColumnsHumanReadable","Array","from","keys","togglePlot","toggleFilter","toggleMap","mapSelectChanged","mapLayerChanged","waitingUserCount","fleetManager","unconfirmedTailsCount","modifyTailsAccess","display","setFilter","setCurrentSortingColumn","getCurrentSortingColumn","setSortingColumn","getSortingColumn","setSortingOrder","getSortingOrder","elem","setAvailableLayers","addTag","perm","deleteTag","getUnassociatedTags","associateTag","clearTags","editTag","global","plotlyLayout","shapes","render","querySelector","ready","newPlot","myPlot","on","xaxis","points","yaxis","x","getLayers","hiddenStyle","stroke","flightState","image","radius","visibleStyle","getVisible","trackingPoint","setStyle","getGeometry","setCoordinates"],"sources":["/ngafid/ngafid2.0/src/main/javascript/flights.js"],"sourcesContent":["import 'bootstrap';\nimport React, { Component } from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport SignedInNavbar from \"./signed_in_navbar.js\";\nimport { map, styles, layers, Colors, initializeMap } from \"./map.js\";\n\nimport {Group, Vector as VectorLayer} from 'ol/layer.js';\nimport {Vector as VectorSource} from 'ol/source.js';\nimport {Circle, Fill, Icon, Stroke, Style} from 'ol/style.js';\n\nimport { errorModal } from \"./error_modal.js\";\nimport { confirmModal } from \"./confirm_modal.js\";\n\nimport { Filter } from './filter.js';\nimport { Paginator } from './paginator_component.js';\nimport { FlightsCard } from './flights_card_component.js';\n\nimport Plotly from 'plotly.js';\n\nimport { timeZones } from \"./time_zones.js\";\n\n\nfunction invalidString(str){\n    return (str == null || str.length < 0 || /^\\s*$/.test(str));\n}\n\n/*\nvar airframes = [ \"PA-28-181\", \"Cessna 172S\", \"PA-44-180\", \"Cirrus SR20\"  ];\nvar tailNumbers = [ \"N765ND\", \"N744ND\", \"N771ND\", \"N731ND\", \"N714ND\", \"N766ND\", \"N743ND\" , \"N728ND\" , \"N768ND\" , \"N713ND\" , \"N732ND\", \"N718ND\" , \"N739ND\" ];\nvar doubleTimeSeriesNames = [ \"E1 CHT1\", \"E1 CHT2\", \"E1 CHT3\" ];\nvar visitedAirports = [ \"GFK\", \"FAR\", \"ALB\", \"ROC\" ];\n*/\n// var tagNames = [\"Tag A\", \"Tag B\"];\nvar rules = [\n    {\n        name : \"Airframe\",\n        conditions : [\n            { \n                type : \"select\",\n                name : \"condition\",\n                options : [ \"is\", \"is not\" ]\n            },\n            { \n                type : \"select\",\n                name : \"airframes\",\n                options : airframes\n            }\n        ]\n    },\n\n    {\n        name : \"Tail Number\",\n        conditions : [\n            { \n                type : \"select\",\n                name : \"condition\",\n                options : [ \"is\", \"is not\" ]\n            },\n            {\n                type : \"select\",\n                name : \"tail numbers\",\n                options : tailNumbers\n            }\n        ]\n    },\n\n    {\n        name : \"System ID\",\n        conditions : [\n            { \n                type : \"select\",\n                name : \"condition\",\n                options : [ \"is\", \"is not\" ]\n            },\n            {\n                type : \"select\",\n                name : \"system id\",\n                options : systemIds \n            }\n        ]\n    },\n\n\n    {\n        name : \"Duration\",\n        conditions : [\n            { \n                type : \"select\",\n                name : \"condition\",\n                options : [ \"<=\", \"<\", \"=\", \">\", \">=\" ]\n            },\n            {\n                type : \"number\",\n                name : \"hours\"\n            },\n            {\n                type : \"number\",\n                name : \"minutes\"\n            },\n            {\n                type : \"number\",\n                name : \"seconds\"\n            }\n        ]\n    },\n\n    {\n        name : \"Start Date and Time\",\n        conditions : [\n            {\n                type : \"select\",\n                name : \"condition\", \n                options : [ \"<=\", \"<\", \"=\", \">\", \">=\" ]\n            },\n            {\n                type  : \"datetime-local\",\n                name : \"date and time\"\n            },\n            {\n                type : \"select\",\n                name : \"timezone\", \n                options : timeZones\n            }\n        ]\n    },\n\n    {\n        name : \"End Date and Time\",\n        conditions : [\n            {\n                type : \"select\",\n                name : \"condition\", \n                options : [ \"<=\", \"<\", \"=\", \">\", \">=\" ]\n            },\n            {\n                type  : \"datetime-local\",\n                name : \"date and time\"\n            },\n            {\n                type : \"select\",\n                name : \"timezone\", \n                options : timeZones\n            }\n        ]\n    },\n\n    {\n        name : \"Start Date\",\n        conditions : [\n            {\n                type : \"select\",\n                name : \"condition\", \n                options : [ \"<=\", \"<\", \"=\", \">\", \">=\" ]\n            },\n            {\n                type  : \"date\",\n                name : \"date\"\n            }\n        ]\n    },\n\n    {\n        name : \"End Date\",\n        conditions : [\n            {\n                type : \"select\",\n                name : \"condition\", \n                options : [ \"<=\", \"<\", \"=\", \">\", \">=\" ]\n            },\n            {\n                type  : \"date\",\n                name : \"date\"\n            }\n        ]\n    },\n\n    {\n        name : \"Start Time\",\n        conditions : [\n            {\n                type : \"select\",\n                name : \"condition\",\n                options : [ \"<=\", \"<\", \"=\", \">\", \">=\" ]\n            },\n            {\n                type  : \"time\",\n                name : \"time\"\n            },\n            {\n                type : \"select\",\n                name : \"timezone\", \n                options : timeZones\n            }\n        ]\n    },\n\n    {\n        name : \"End Time\",\n        conditions : [\n            {\n                type : \"select\",\n                name : \"condition\",\n                options : [ \"<=\", \"<\", \"=\", \">\", \">=\" ]\n            },\n            {\n                type  : \"time\",\n                name : \"time\"\n            },\n            {\n                type : \"select\",\n                name : \"timezone\", \n                options : timeZones\n            }\n        ]\n    },\n\n\n    {\n        name : \"Parameter\",\n        conditions : [\n            {\n                type : \"select\",\n                name : \"statistic\",\n                options : [ \"min\", \"avg\", \"max\" ]\n            },\n            {\n                type : \"select\",\n                name : \"doubleSeries\",\n                options : doubleTimeSeriesNames\n            },\n            {\n                type : \"select\",\n                name : \"condition\",\n                options : [ \"<=\", \"<\", \"=\", \">\", \">=\" ]\n            },\n            {\n                type  : \"number\",\n                name : \"number\"\n            }\n        ]\n    },\n\n    {\n        name : \"Airport\",\n        conditions : [\n            { \n                type : \"select\",\n                name : \"airports\",\n                options : visitedAirports\n            },\n            { \n                type : \"select\",\n                name : \"condition\",\n                options : [ \"visited\", \"not visited\" ]\n            }\n        ]\n    },\n\n    {\n        name : \"Runway\",\n        conditions : [\n            { \n                type : \"select\",\n                name : \"runways\",\n                options : visitedRunways\n            },\n            { \n                type : \"select\",\n                name : \"condition\",\n                options : [ \"visited\", \"not visited\" ]\n            }\n        ]\n    },\n\n    {\n        name : \"Event Count\",\n        conditions : [\n            {\n                type : \"select\",\n                name : \"eventNames\",\n                options : eventNames\n            },\n            {\n                type : \"select\",\n                name : \"condition\",\n                options : [ \"<=\", \"<\", \"=\", \">\", \">=\" ]\n            },\n            {\n                type  : \"number\",\n                name : \"number\"\n            }\n        ]\n    },\n\n    {\n        name : \"Event Severity\",\n        conditions : [\n            {\n                type : \"select\",\n                name : \"eventNames\",\n                options : eventNames\n            },\n            {\n                type : \"select\",\n                name : \"condition\",\n                options : [ \"<=\", \"<\", \"=\", \">\", \">=\" ]\n            },\n            {\n                type  : \"number\",\n                name : \"number\"\n            }\n        ]\n    },\n\n    {\n        name : \"Event Duration\",\n        conditions : [\n            {\n                type : \"select\",\n                name : \"eventNames\",\n                options : eventNames\n            },\n            {\n                type : \"select\",\n                name : \"condition\",\n                options : [ \"<=\", \"<\", \"=\", \">\", \">=\" ]\n            },\n            {\n                type  : \"number\",\n                name : \"number\"\n            }\n        ]\n    },\n\n    {\n        name : \"Tag\",\n        conditions : [\n            {\n                type : \"select\",\n                name : \"flight_tags\",\n                options : tagNames\n            },\n            {\n                type : \"select\",\n                name : \"condition\",\n                options : [ \"Is Associated\", \"Is Not Associated\"]\n            },\n        ]\n    },\n\n\n];\n\nconst sortableColumns = new Map();\n\nsortableColumns.set(\"Flight Number\", \"id\");\nsortableColumns.set(\"Flight Length (Number of Valid Data Points)\", \"number_rows\");\nsortableColumns.set(\"Start Date and Time\", \"start_time\");\nsortableColumns.set(\"End Date and Time\", \"end_time\");\nsortableColumns.set(\"Number of Airports Visited\", \"airports_visited\");\nsortableColumns.set(\"Number of Tags Associated\", \"flight_tags\");\nsortableColumns.set(\"Total Event Count\", \"events\");\nsortableColumns.set(\"System ID\", \"system_id\");\nsortableColumns.set(\"Tail Number\", \"tail_number\");\nsortableColumns.set(\"Airframe\", \"airframe_id\");\nsortableColumns.set(\"Number of Takeoffs/Landings\", \"itinerary\");\n\nclass FlightsPage extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            filterVisible : true,\n            filterSelected : true,\n            plotVisible : false,\n            plotSelected : false,\n            mapVisible : false,\n            mapSelected : false,\n            mapStyle : \"Road\",\n            flightsRef : React.createRef(),\n            layers : [],\n            flights : undefined, //start out with no specified flights\n            sortColumn : \"Start Date and Time\", //need to define a default here, flt# will alias to primary key server side\n            sortingOrder : \"Descending\", //need to define a default here, descending is default\n            storedFilters : this.getStoredFilters(),\n\n            filters : {\n                type : \"GROUP\",\n                condition : \"AND\",\n                filters : []\n            }, \n\n            //needed for paginator\n            currentPage : 0,\n            numberPages : 1,\n            pageSize : 10\n        };\n\n        this.navRef = React.createRef();\n    }\n\n    mapSelectChanged(style) {\n        for (var i = 0, ii = layers.length; i < ii; ++i) {\n            console.log(\"setting layer \" + i + \" to:\" + (styles[i] === style));\n            layers[i].setVisible(styles[i] === style);\n        }   \n\n        console.log(\"map style changed to: '\" +  style + \"'!\");\n        this.setState({\n            mapStyle : style\n        });\n    }\n\n    mapLayerChanged(style) {\n        console.log(\"changing path to: \"+style);\n        console.log(this.state.selectableLayers);\n\n        for(let i = 0; i < this.state.selectableLayers.length; i++){\n            let layer = this.state.selectableLayers[i];\n            let name = layer.values_.name;\n            \n            if(name == style) {\n                layer.setVisible(true);\n                console.log(\"setting layer \" + name + \" to visible\");\n            } else {\n                layer.setVisible(false);\n                console.log(\"setting layer \" + name + \" to not visible\");\n            }\n        }\n\n        console.log(\"map layer changed to: '\" +  style + \"'!\");\n\n        this.setMapStyle(style);\n        \n    }\n\n    setMapStyle(style) {\n         this.setState({\n            mapStyle : style\n        });\n    }\n\n    setSortingColumn(column) {\n        console.log(\"sorting by: \" + column);\n        this.state.sortColumn = column;\n        this.setState(this.state);\n\n        this.submitFilter(true);\n    }\n\n    getSortingColumn() {\n        return this.state.sortColumn;\n    }\n\n    setSortingOrder(order) {\n        if (order != this.state.sortingOrder) {\n            console.log(\"sorting in \" + order + \" order\");\n            this.state.sortingOrder = order;\n            this.setState(this.state);\n            this.submitFilter(true);\n        }\n    }\n\n    getSortingOrder() {\n        return this.state.sortingOrder;\n    }\n\n    showMap() {\n        if (this.state.mapVisible) return;\n\n        if ( !$(\"#map-toggle-button\").hasClass(\"active\") ) { \n            $(\"#map-toggle-button\").addClass(\"active\");\n            $(\"#map-toggle-button\").attr(\"aria-pressed\", true);\n        }\n\n        this.state.mapVisible = true;\n        this.setState(this.state);\n\n        $(\"#plot-map-div\").css(\"height\", \"50%\");\n        $(\"#map\").show();\n\n        if (this.state.plotVisible) {\n            $(\"#map\").css(\"width\", \"50%\");\n            map.updateSize();\n            $(\"#plot\").css(\"width\", \"50%\");\n            Plotly.Plots.resize(\"plot\");\n        } else {\n            $(\"#map\").css(\"width\", \"100%\");\n            map.updateSize();\n        }\n\n    }\n\n    hideMap() {\n        if (!this.state.mapVisible) return;\n\n        if ( $(\"#map-toggle-button\").hasClass(\"active\") ) { \n            $(\"#map-toggle-button\").removeClass(\"active\");\n            $(\"#map-toggle-button\").attr(\"aria-pressed\", false);\n        }   \n\n        this.state.mapVisible = false;\n        this.setState(this.state);\n\n        $(\"#map\").hide();\n\n        if (this.state.plotVisible) {\n            $(\"#plot\").css(\"width\", \"100%\");\n            var update = { width : \"100%\" };\n            Plotly.Plots.resize(\"plot\");\n        } else {\n            $(\"#plot-map-div\").css(\"height\", \"0%\");\n        }\n    }\n\n    toggleMap() {\n        if (this.state.mapVisible) {\n            this.hideMap();\n        } else {\n            this.showMap();\n        }\n    }\n\n    showPlot() {\n        if (this.state.plotVisible) return;\n\n        if ( !$(\"#plot-toggle-button\").hasClass(\"active\") ) { \n            $(\"#plot-toggle-button\").addClass(\"active\");\n            $(\"#plot-toggle-button\").attr(\"aria-pressed\", true);\n        }\n\n        this.state.plotVisible = true;\n        this.setState(this.state);\n\n        $(\"#plot\").show();\n        $(\"#plot-map-div\").css(\"height\", \"50%\");\n\n        if (this.state.mapVisible) {\n            $(\"#map\").css(\"width\", \"50%\");\n            map.updateSize();\n            $(\"#plot\").css(\"width\", \"50%\");\n            Plotly.Plots.resize(\"plot\");\n        } else {\n            $(\"#plot\").css(\"width\", \"100%\");\n            Plotly.Plots.resize(\"plot\");\n        }\n    }\n\n    hidePlot() {\n        if (!this.state.plotVisible) return;\n\n        if ( $(\"#plot-toggle-button\").hasClass(\"active\") ) { \n            $(\"#plot-toggle-button\").removeClass(\"active\");\n            $(\"#plot-toggle-button\").attr(\"aria-pressed\", false);\n        }   \n\n        this.state.plotVisible = false;\n        this.setState(this.state);\n\n        $(\"#plot\").hide();\n\n        if (this.state.mapVisible) {\n            $(\"#map\").css(\"width\", \"100%\");\n            map.updateSize();\n        } else {\n            $(\"#plot-map-div\").css(\"height\", \"0%\");\n        }\n    }\n\n    togglePlot() {\n        if (this.state.plotVisible) {\n            this.hidePlot();\n        } else {\n            this.showPlot();\n        }\n    }\n\n\n    toggleFilter() {\n        console.log(\"toggling filterVisible to: \" + !this.state.filterVisible);\n        this.setState({\n            filterVisible : !this.state.filterVisible\n        });\n    }\n\n    setFilter(filter) {\n        this.setState({\n            filters : filter\n        });\n    }\n\n\n    getStoredFilters() {\n        let storedFilters = [];\n\n        $.ajax({\n            type: 'GET',\n            url: '/protected/stored_filters',\n            dataType : 'json',\n            success : function(response) {\n                console.log(\"received filters response: \");\n                console.log(response);\n                \n                storedFilters = response;\n            },   \n            error : function(jqXHR, textStatus, errorThrown) {\n            },   \n            async: false \n        });  \n\n        return storedFilters;\n    }\n\n    submitFilter(resetCurrentPage = false) {\n        console.log(\"submitting filter! currentPage: \" + this.state.currentPage + \", pageSize: \" + this.state.pageSize + \" sortByColumn: \" + this.state.sortColumn);\n\n        console.log(\"Submitting filters:\");\n        console.log( this.state.filters );\n\n        $(\"#loading\").show();\n\n        //reset the current page to 0 if the page size or filter\n        //have changed\n        let currentPage = this.state.currentPage;\n        if (resetCurrentPage === true) {\n            currentPage = 0;\n        }\n\n        var submissionData = {\n            filterQuery : JSON.stringify(this.state.filters),\n            currentPage : currentPage,\n            pageSize : this.state.pageSize,\n            sortingColumn : sortableColumns.get(this.state.sortColumn),\n            sortingOrder : this.state.sortingOrder\n        };\n\n        console.log(submissionData);\n\n        let flightsPage = this;\n\n        $.ajax({\n            type: 'POST',\n            url: '/protected/get_flights',\n            data : submissionData,\n            dataType : 'json',\n            timeout : 0, //set timeout to be unlimited for slow queries\n            success : function(response) {\n\n                console.log(response);\n\n                $(\"#loading\").hide();\n\n                if (response.errorTitle) {\n                    console.log(\"displaying error modal!\");\n                    errorModal.show(response.errorTitle, response.errorMessage);\n                    return false;\n                }\n\n                console.log(\"got response: \" + response + \" \" + response.size);\n\n                //get page data\n                if (response == \"NO_RESULTS\") {\n                    errorModal.show(\"No flights found with the given parameters!\", \"Please try a different query.\");\n                 } else {\n                    flightsPage.setState({\n                        flights : response.flights,\n                        currentPage : currentPage,\n                        numberPages : response.numberPages  \n                    });\n\n                }\n            },\n            error : function(jqXHR, textStatus, errorThrown) {\n                errorModal.show(\"Error Loading Flights\", errorThrown);\n            },   \n            async: true \n        });  \n    }\n\n    setAvailableLayers(plotLayers) {\n        console.log(\"changing selectable layers on navbar\");\n        console.log(plotLayers);\n\n        this.setState({selectableLayers : plotLayers});\n    }\n\n    //Tag Methods:\n    //\n\n    addTag(flightId, name, description, color) {\n        if (invalidString(name) || invalidString(description)) {\n            errorModal.show(\"Error creating tag!\",\n                            \"Please ensure the name and description fields are correctly filled out!\");\n            return;\n        }\n\n        var submissionData = {\n            name : name,\n            description : description,\n            color : color,\n            id : flightId\n        };\n        console.log(\"Creating a new tag for flight # \" + this.state.flightId);\n\n        let thisFlight = this;\n\n        $.ajax({\n            type: 'POST',\n            url: '/protected/create_tag',\n            data : submissionData,\n            dataType : 'json',\n            success : function(response) {\n                console.log(\"received response: \");\n                console.log(response);\n                if (response != \"ALREADY_EXISTS\") {\n                    for (var i = 0; i < thisFlight.state.flights.length; i++) {\n                        let flight = thisFlight.state.flights[i];\n                        if (flight.id == flightId) {\n                            if (flight.tags != null && flight.tags.length > 0) {\n                                flight.tags.push(response);\n                            } else {\n                                flight.tags = [response];\n                            }\n                        }\n                    }\n                    thisFlight.setState(thisFlight.state);\n                } else {\n                    errorModal.show(\"Error creating tag\", \"A tag with that name already exists! Use the dropdown menu to associate it with this flight or give this tag another name\");\n                }\n            },   \n            error : function(jqXHR, textStatus, errorThrown) {\n            },   \n            async: true \n        });  \n    }\n\n    /**\n     * Calls the server using ajax-json to notify it of the new tag change\n     */\n    editTag(newTag, currentTag) {\n        console.log(\"submitting edit for tag: \"+currentTag.hashId);\n\n        console.log(\"current tag\");\n        console.log(currentTag);\n\n        console.log(\"new tag\");\n        console.log(newTag);\n\n        var submissionData = {\n            tag_id : currentTag.hashId,\n            name : newTag.name,\n            description : newTag.description,\n            color : newTag.color\n        };\n\n        let thisFlight = this;\n\n        $.ajax({\n            type: 'POST',\n            url: '/protected/edit_tag',\n            data : submissionData,\n            dataType : 'json',\n            success : function(response) {\n                console.log(\"received response: \");\n                console.log(response);\n                if (response != \"NOCHANGE\") {\n                    console.log(\"tag was edited!\");\n\n                    for (var i = 0; i < thisFlight.state.flights.length; i++) {\n                        let flight = thisFlight.state.flights[i];\n                        console.log(flight);\n                        console.log(currentTag);\n                        if (flight.tags != null && flight.tags.length > 0) {\n                            let tags = flight.tags;\n                            for (var j = 0; j < tags.length; j++) {\n                                let tag = tags[j];\n                                if (tag.hashId == currentTag.hashId) {\n                                    tags[j] = response;\n                                }\n                            }\n                        }\n                    } \n                    thisFlight.setState(thisFlight.state);\n                } else {\n                    thisFlight.showNoEditError();\n                }\n                thisFlight.setState(thisFlight.state);\n            },\n            error : function(jqXHR, textStatus, errorThrown) {\n            },\n            async: true\n        });\n    }\n\n    getUnassociatedTags(flightId) {\n        console.log(\"getting unassociated tags!\")\n\n        let tags = [];\n\n        var submissionData = {\n            id : flightId\n        };\n\n        $.ajax({\n            type: 'POST',\n            url: '/protected/get_unassociated_tags',\n            data : submissionData,\n            dataType : 'json',\n            success : function(response) {\n                console.log(\"received response: \");\n                console.log(response);\n\n                tags = response;\n            },   \n            error : function(jqXHR, textStatus, errorThrown) {\n            },   \n            async: false \n        });  \n\n        return tags;\n    }\n\n    /**\n     * Handles when the user presses the delete button, and prompts them with @module confirmModal\n     */\n    deleteTag(flightId, tagId) {\n        console.log(tag);\n        if (tagId != null) {\n            console.log(\"delete tag invoked!\");\n            confirmModal.show(\"Confirm Delete Tag: '\" + tag.name + \"'\",\n                \"Are you sure you wish to delete this tag?\\n\\nThis operation will remove it from this flight as well as all other flights that this tag is associated with. This operation cannot be undone!\",\n                () => {this.removeTag(flightId, tagId, true)}\n            );\n        } else {\n            errorModal.show(\"Please select a tag to delete first!\",\n                            \"You did not select a tag to delete\");\n        }\n\n    }\n\n    /**\n     * removes a tag from a flight, either permanent or just from one flight\n     * @param id the tagid of the tag being removed\n     * @param tag is the tag being removed\n     * @param isPermanent a bool representing whether or not the removal is permanent\n     */\n    removeTag(flightId, tagId, isPermanent) {\n        console.log(\"un-associating tag #\" + tagId + \" with flight #\" + flightId);\n\n        if (tagId == null || tagId == -1) {\n            errorModal.show(\"Please select a flight to remove first!\", \"Cannot remove any flights!\");\n            return;\n        }\n\n        var submissionData = {\n            flight_id : flightId,\n            tag_id : tagId,\n            permanent : isPermanent,\n            all : (tagId == -2)\n        };\n\n        let thisFlight = this;\n        console.log(\"calling deletion ajax\");\n\n        $.ajax({\n            type: 'POST',\n            url: '/protected/remove_tag',\n            data : submissionData,\n            dataType : 'json',\n            success : function(response) {\n                console.log(\"received response: \");\n                console.log(response);\n                if (isPermanent) {\n                    console.log(\"permanent deletion of tag with id: \" + tagId);\n                    for (var i = 0; i < thisFlight.state.flights.length; i++) {\n                        let flight = thisFlight.state.flights[i];\n                        console.log(flight);\n                        if (flight.tags != null) {\n                            let tags = flight.tags;\n                            for (var j = 0; j < tags.length; j++) {\n                                let tag = tags[j];\n                                if (tagId == response.tagId) {\n                                    tags.splice(j, 1);\n                                }\n                            }\n                        }\n                    } \n                } else if (response.allTagsCleared) {\n                    for (var i = 0; i < thisFlight.state.flights.length; i++) {\n                        let flight = thisFlight.state.flights[i];\n                        if (flight.id == flightId) {\n                            flight.tags = [];\n                        }\n                    } \n                } else {\n                    for (var i = 0; i < thisFlight.state.flights.length; i++) {\n                        let flight = thisFlight.state.flights[i];\n                        let tags = flight.tags;\n                        if (flight.id == flightId) {\n                            let tags = flight.tags;\n                            tags.splice(tags.indexOf(tag), 1);\n                        }\n                    }\n                } \n                thisFlight.setState(thisFlight.state);\n            },   \n            error : function(jqXHR, textStatus, errorThrown) {\n            },   \n            async: false \n        });  \n    }\n\n    /**\n     * Associates a tag with this flight\n     * @param id the tag id to associate\n     */\n    associateTag(tagId, flightId) {\n        console.log(\"associating tag #\"+tagId+\" with flight #\"+flightId);\n\n        var submissionData = {\n            id : flightId,\n            tag_id : tagId\n        };\n\n        let thisFlight = this;\n\n        $.ajax({\n            type: 'POST',\n            url: '/protected/associate_tag',\n            data : submissionData,\n            dataType : 'json',\n            success : function(response) {\n                console.log(\"received response: \");\n                console.log(response);\n                for (var i = 0; i < thisFlight.state.flights.length; i++) {\n                    let flight = thisFlight.state.flights[i];\n                    if (flight.id == flightId) {\n                        if (flight.tags != null && flight.tags.length > 0) {\n                            flight.tags.push(response);\n                        } else {\n                            flight.tags = [response];\n                        }\n                    }\n                }\n                thisFlight.setState(thisFlight.state);\n            },   \n            error : function(jqXHR, textStatus, errorThrown) {\n            },   \n            async: true \n        });  \n    }\n\n\n    /**\n     * Handles when the user presses the clear all tags button, and prompts them with @module confirmModal\n     */\n    clearTags(flightId) {\n        confirmModal.show(\"Confirm action\", \"Are you sure you would like to remove all the tags from flight #\" + flightId + \"?\",\n                          () => {this.removeTag(flightId, -2, false)});\n    }\n\n    /**\n     * Handles clearing all selected flights for multiple flight replays\n     */\n     clearCesiumFlights() {\n         cesiumFlightsSelected.forEach((removedFlight) => {\n             console.log(\"Removed \" + removedFlight);\n             let toggleButton = document.getElementById(\"cesiumToggled\" + removedFlight);\n             toggleButton.click();\n         });\n\n         if (cesiumFlightsSelected.length > 0) {\n             this.clearCesiumFlights();\n         }\n    }\n\n    render() {\n        let style = null;\n        if (this.state.mapVisible || this.state.plotVisible) {\n            console.log(\"rendering half\");\n            style = { \n                overflow : \"scroll\",\n                height : \"calc(50%)\"\n            };  \n        } else {\n            style = { \n                overflow : \"scroll\",\n                height : \"calc(100%)\"\n            };  \n        }\n\n        style.padding = \"5\";\n\n        let sortableColumnsHumanReadable = Array.from(sortableColumns.keys());\n\n        return (\n            <div>\n                <SignedInNavbar \n                    activePage=\"flights\"\n                    selectableLayers={this.state.selectableLayers}\n                    filterVisible={true}\n                    plotVisible={this.state.plotVisible}\n                    mapVisible={this.state.mapVisible}\n                    filterSelected={this.state.filterSelected}\n                    plotSelected={this.state.plotSelected}\n                    mapSelected={this.state.mapSelected}\n                    mapStyle={this.state.mapStyle}\n                    togglePlot={() => this.togglePlot()}\n                    toggleFilter={() => this.toggleFilter()}\n                    toggleMap={() => this.toggleMap()}\n                    mapSelectChanged={(style) => this.mapSelectChanged(style)}\n                    mapLayerChanged={(style) => this.mapLayerChanged(style)}\n                    waitingUserCount={waitingUserCount}\n                    fleetManager={fleetManager}\n                    ref={this.navRef}\n                    unconfirmedTailsCount={unconfirmedTailsCount}\n                    modifyTailsAccess={modifyTailsAccess}\n                />\n\n                <div id=\"plot-map-div\" className='row m-0' style={{width:\"100%\", height:\"0%\"}}>\n                    <div id=\"map\" className=\"map\" style={{width:\"50%\", display:\"none\"}}></div> \n                    <div id=\"plot\" style={{width:\"50%\", display:\"none\"}}></div>\n                </div>\n\n                <div style={style}>\n                    <Filter\n                        filterVisible={this.state.filterVisible}\n\n                        submitButtonName=\"Apply Filter\"\n                        submitFilter={(resetCurrentPage) => {this.submitFilter(resetCurrentPage);}}\n\n                        rules={rules}\n                        filters={this.state.filters}\n\n                        getFilter={() => {return this.state.filters}}\n                        setFilter={(filter) => this.setFilter(filter)}\n                        setCurrentSortingColumn={(sortColumn) => this.setCurrentSortingColumn(sortColumn)}\n                        getCurrentSortingColumn={() => this.getCurrentSortingColumn()}\n\n                    />\n\n                    <Paginator\n                        submitFilter={(resetCurrentPage) => {this.submitFilter(resetCurrentPage);}}\n                        items={this.state.flights}\n                        itemName=\"flights\"\n                        currentPage={this.state.currentPage}\n                        numberPages={this.state.numberPages}\n                        pageSize={this.state.pageSize}\n                        rules={sortableColumns}\n                        setClearButton={() => this.clearCesiumFlights()}\n                        setSortingColumn={(sortColumn) => this.setSortingColumn(sortColumn)}\n                        getSortingColumn={() => this.getSortingColumn()}\n                        setSortingOrder={(order) => this.setSortingOrder(order)}\n                        getSortingOrder={() => this.getSortingOrder()}\n                        sortOptions = {sortableColumnsHumanReadable}\n                        updateCurrentPage={(currentPage) => {\n                            this.state.currentPage = currentPage;\n                        }}\n                        updateItemsPerPage={(pageSize) => {\n                            this.state.pageSize = pageSize;\n                        }}\n                        location=\"Top\"\n                    />\n\n                    <FlightsCard\n                        parent={this}\n                        layers={this.state.layers}\n                        flights={this.state.flights} \n                        navBar={this.navRef}\n                        ref={elem => this.flightsRef = elem}\n                        showMap={() => {this.showMap();}}\n                        showPlot={() => {this.showPlot();}}\n                        setAvailableLayers={(plotLayers) => {this.setAvailableLayers(plotLayers);}}\n                        setFlights={(flights) => {\n                            this.setState({\n                                flights : flights\n                            });\n                        }}\n                        updateNumberPages={(numberPages) => {\n                            this.setState({\n                                numberPages : numberPages\n                            });\n                        }}\n\n                        addTag={(flightId, name, description, color) => this.addTag(flightId, name, description, color)}\n                        removeTag={(flightId, tagId, perm) => this.removeTag(flightId, tagId, perm)}\n                        deleteTag={(flightId, tagId) => this.deleteTag(flightId, tagId)}\n                        getUnassociatedTags={(flightId) => this.getUnassociatedTags(flightId)}\n                        associateTag={(tagId, flightId) => this.associateTag(tagId, flightId)}\n                        clearTags={(flightId) => this.clearTags(flightId)}\n                        editTag={(currentTag, newTag) => this.editTag(currentTag, newTag)}\n                    />\n\n                    <Paginator\n                        submitFilter={(resetCurrentPage) => {this.submitFilter(resetCurrentPage);}}\n                        items={this.state.flights}\n                        itemName=\"flights\"\n                        rules={sortableColumns}\n                        currentPage={this.state.currentPage}\n                        numberPages={this.state.numberPages}\n                        pageSize={this.state.pageSize}\n                        setSortingColumn={(sortColumn) => this.setSortingColumn(sortColumn)}\n                        getSortingColumn={() => this.getSortingColumn()}\n                        setSortingOrder={(order) => this.setSortingOrder(order)}\n                        getSortingOrder={() => this.getSortingOrder()}\n                        sortOptions = {sortableColumnsHumanReadable}\n                        updateCurrentPage={(currentPage) => {\n                            this.state.currentPage = currentPage;\n                        }}\n                        updateItemsPerPage={(pageSize) => {\n                            this.state.pageSize = pageSize;\n                        }}\n                        location=\"Bottom\"\n                    />\n\n                </div>\n            </div>\n        );\n    }\n}\n\nglobal.plotlyLayout = { \n    shapes : []\n};\n\nvar flightsPage = ReactDOM.render(\n    <FlightsPage />,\n    document.querySelector('#flights-page')\n);\n\n\nconsole.log(\"rendered flightsCard!\");\n\n\n//need to wait for the page to load before initializing maps\n//TODO: this is the same as in flights.js, put it in a single spot\n$(document).ready(function() {\n    Plotly.newPlot('plot', [], global.plotlyLayout);\n\n    initializeMap();\n\n    var myPlot = document.getElementById(\"plot\");\n    console.log(\"myPlot:\");\n    console.log(myPlot);\n\n    myPlot.on('plotly_hover', function(data) {\n        var xaxis = data.points[0].xaxis,\n            yaxis = data.points[0].yaxis;\n\n        /*\n            var infotext = data.points.map(function(d) {\n                return ('width: '+xaxis.l2p(d.x)+', height: '+yaxis.l2p(d.y));\n            });\n            */\n\n        //console.log(\"in hover!\");\n        //console.log(data);\n        let x = data.points[0].x;\n\n        //console.log(\"x: \" + x);\n\n        map.getLayers().forEach(function(layer) {\n            if (layer instanceof VectorLayer) {\n                if ('flightState' in layer) {\n                    //console.log(\"VECTOR layer:\");\n\n                    var hiddenStyle = new Style({\n                        stroke: new Stroke({\n                            color: layer.flightState.state.color,\n                            width: 1.5\n                        }),\n                        image: new Circle({\n                            radius: 5,\n                            stroke: new Stroke({\n                                color: [0,0,0,0],\n                                width: 2\n                            })\n                        })\n                    });\n\n                    var visibleStyle = new Style({\n                        stroke: new Stroke({\n                            color: layer.flightState.state.color,\n                            width: 1.5\n                        }),\n                        image: new Circle({\n                            radius: 5,\n                            stroke: new Stroke({\n                                color: layer.flightState.state.color,\n                                width: 2\n                            })\n                        })\n                    });\n\n                    if (layer.getVisible()) {\n                        if (x < layer.flightState.state.points.length) {\n                            console.log(\"need to draw point at: \" + layer.flightState.state.points[x]);\n                            layer.flightState.state.trackingPoint.setStyle(visibleStyle);\n                            layer.flightState.state.trackingPoint.getGeometry().setCoordinates(layer.flightState.state.points[x]);\n                        } else {\n                            console.log(\"not drawing point x: \" + x + \" >= points.length: \" + layer.flightState.state.points.length);\n                            layer.flightState.state.trackingPoint.setStyle(hiddenStyle);\n                        }\n                    }\n                }\n            }\n        });\n    });\n\n});\n"],"mappings":"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"}]}